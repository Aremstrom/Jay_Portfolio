import { useEffect, useRef } from "react";
import { gsap } from "gsap";
import Lenis from "@studio-freight/lenis";

import { ScrollTrigger } from "gsap/ScrollTrigger";

export default function NavBar({ sectionRefs }) {
  const navBar = useRef(null);
  const logo = useRef(null);
  const cta = useRef(null);
  const tl = gsap.timeline();
  gsap.registerPlugin(ScrollTrigger);

  useEffect(() => {
    const lenis = new Lenis();
    function raf(time) {
      lenis.raf(time);
      requestAnimationFrame(raf);
    }
    requestAnimationFrame(raf);
  });

  useEffect(() => {
    tl.to(navBar.current, {
      y: 0,
      duration: 3,
      delay: 0.5,
      ease: "power4.inOut",
    });
  });

  useEffect(() => {
    sectionRefs.forEach((section) => {
      ScrollTrigger.create({
        trigger: section,
        start: "top 375px",
        end: "bottom 300px",
        // markers: true,
        animation: gsap
          .timeline()
          .to(navBar.current, { color: "#DDDDD5" })
          .to(cta.current, { backgroundColor: "#D1D1C7", color: "#0E0E0C" }, 0)
          .to(".bg-secondary-100", { backgroundColor: "#0E0E0C" }, 0),

        toggleActions: "restart reverse restart reverse",
      });
    });
  });

  return (
    <header
      ref={navBar}
      className="fixed top-0 z-50 flex w-full -translate-y-full items-center justify-between bg-secondary-100 px-5 py-3"
    >
      {/* logo */}
      <a href="#hero" aria-label="Logo" className="z-50">
        <svg
          ref={logo}
          width="80"
          height="45"
          viewBox="0 0 121 45"
          fill="currentColor"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path d="M11.872 10.152H12.64C13.408 10.152 14.16 10.248 14.896 10.44C15.632 10.6 16.288 10.904 16.864 11.352C17.44 11.768 17.904 12.344 18.256 13.08C18.608 13.816 18.784 14.76 18.784 15.912V32.568C18.784 33.752 18.592 34.712 18.208 35.448C17.856 36.184 17.376 36.76 16.768 37.176C16.192 37.592 15.504 37.88 14.704 38.04C13.936 38.2 13.152 38.28 12.352 38.28H11.872V10.152ZM4.24 40.392C4.24 39.4 4.432 38.6 4.816 37.992C5.2 37.352 5.664 36.856 6.208 36.504C6.752 36.152 7.328 35.928 7.936 35.832C8.544 35.704 9.072 35.64 9.52 35.64C9.904 35.64 10.224 35.672 10.48 35.736V37.944C10.48 38.616 10.64 39.112 10.96 39.432C11.28 39.752 11.68 39.912 12.16 39.912C12.736 39.912 13.248 39.72 13.696 39.336C13.792 39.592 13.84 39.832 13.84 40.056C13.872 40.248 13.888 40.472 13.888 40.728C13.888 41.112 13.792 41.56 13.6 42.072C13.44 42.552 13.168 43.016 12.784 43.464C12.432 43.88 11.952 44.248 11.344 44.568C10.768 44.856 10.064 45 9.232 45C8.368 45 7.616 44.856 6.976 44.568C6.368 44.28 5.856 43.928 5.44 43.512C5.056 43.064 4.752 42.568 4.528 42.024C4.336 41.48 4.24 40.936 4.24 40.392ZM33.5571 28.104C33.5571 27.72 33.5251 27.352 33.4611 27C33.4291 26.648 33.3331 26.344 33.1731 26.088C33.0451 25.8 32.8371 25.576 32.5491 25.416C32.2931 25.224 31.9251 25.128 31.4451 25.128C31.1891 25.128 30.9171 25.176 30.6291 25.272C30.3731 25.336 30.1331 25.464 29.9091 25.656C29.7811 25.4 29.7011 25.16 29.6691 24.936C29.6371 24.68 29.6211 24.424 29.6211 24.168C29.6211 23.144 30.0531 22.296 30.9171 21.624C31.7811 20.952 32.8211 20.616 34.0371 20.616C35.9571 20.616 37.4291 21.112 38.4531 22.104C39.4771 23.064 39.9891 24.456 39.9891 26.28V45C39.2531 45 38.5011 44.92 37.7331 44.76C36.9971 44.568 36.3091 44.264 35.6691 43.848C35.0611 43.4 34.5491 42.824 34.1331 42.12C33.7491 41.384 33.5571 40.456 33.5571 39.336V28.104ZM29.0451 37.512C29.0451 37.896 29.0611 38.264 29.0931 38.616C29.1571 38.968 29.2531 39.288 29.3811 39.576C29.5411 39.832 29.7491 40.056 30.0051 40.248C30.2931 40.408 30.6771 40.488 31.1571 40.488C31.4131 40.488 31.6691 40.456 31.9251 40.392C32.2131 40.296 32.4691 40.152 32.6931 39.96C32.8211 40.216 32.9011 40.472 32.9331 40.728C32.9651 40.952 32.9811 41.192 32.9811 41.448C32.9811 42.472 32.5491 43.32 31.6851 43.992C30.8211 44.664 29.7811 45 28.5651 45C26.6451 45 25.1731 44.488 24.1491 43.464C23.1251 42.44 22.6131 41.16 22.6131 39.624V26.28C22.6131 25.224 22.8051 24.344 23.1891 23.64C23.6051 22.904 24.1171 22.312 24.7251 21.864C25.3651 21.416 26.0531 21.096 26.7891 20.904C27.5571 20.712 28.3091 20.616 29.0451 20.616V37.512ZM50.7483 37.416C50.7483 37.8 50.7643 38.168 50.7963 38.52C50.8603 38.872 50.9563 39.192 51.0843 39.48C51.2443 39.736 51.4523 39.96 51.7083 40.152C51.9963 40.312 52.3803 40.392 52.8603 40.392C53.1163 40.392 53.3723 40.36 53.6283 40.296C53.9163 40.2 54.1723 40.056 54.3963 39.864C54.5243 40.12 54.6043 40.376 54.6363 40.632C54.6683 40.856 54.6843 41.096 54.6843 41.352C54.6843 42.376 54.2683 43.24 53.4363 43.944C52.6043 44.648 51.4683 45 50.0283 45C48.3003 45 46.9083 44.472 45.8523 43.416C44.8283 42.328 44.3163 40.776 44.3163 38.76V20.664H44.6043C46.5243 20.664 48.0283 21.128 49.1163 22.056C50.2043 22.952 50.7483 24.408 50.7483 26.424V37.416ZM61.6923 45.816C61.6923 47.8 61.1163 49.224 59.9643 50.088C58.8443 50.984 57.4523 51.432 55.7883 51.432H55.2603V20.664H55.5483C56.2523 20.664 56.9723 20.76 57.7083 20.952C58.4443 21.144 59.1003 21.464 59.6763 21.912C60.2843 22.328 60.7643 22.888 61.1163 23.592C61.5003 24.296 61.6923 25.144 61.6923 26.136V45.816ZM47.1963 53.496C47.1963 52.504 47.3883 51.688 47.7723 51.048C48.1563 50.44 48.6203 49.96 49.1643 49.608C49.7083 49.256 50.2843 49.016 50.8923 48.888C51.5003 48.792 52.0283 48.744 52.4763 48.744C52.8603 48.744 53.1803 48.776 53.4363 48.84V51.048C53.4363 51.72 53.5963 52.216 53.9163 52.536C54.2363 52.856 54.6363 53.016 55.1163 53.016C55.6923 53.016 56.2043 52.824 56.6523 52.44C56.7483 52.696 56.7963 52.92 56.7963 53.112C56.8283 53.336 56.8443 53.576 56.8443 53.832C56.8443 54.216 56.7483 54.648 56.5563 55.128C56.3963 55.64 56.1243 56.104 55.7403 56.52C55.3883 56.968 54.9083 57.336 54.3003 57.624C53.7243 57.944 53.0203 58.104 52.1883 58.104C51.3243 58.104 50.5723 57.96 49.9323 57.672C49.3243 57.384 48.8123 57.016 48.3963 56.568C48.0123 56.152 47.7083 55.672 47.4843 55.128C47.2923 54.584 47.1963 54.04 47.1963 53.496Z" />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M64 18C59.0445 18 55 13.9555 55 8.99999C55 4.04453 59.0445 -3.45007e-07 64 -3.45007e-07C68.9555 -3.45007e-07 73 4.04453 73 8.99999C73 13.9555 68.9555 18 64 18ZM57.5142 8.99999C57.5142 10.8583 58.3158 12.5708 59.5911 13.7368C60.1012 14.2105 60.9757 14.0648 61.3401 13.4453L63.5992 9.54655C63.8178 9.18218 63.8178 8.74494 63.5992 8.38057L61.3401 4.48178C60.9757 3.82591 60.1012 3.7166 59.5547 4.22672C58.3158 5.46559 57.5142 7.14169 57.5142 8.99999ZM66.6599 4.55466L64.4008 8.45344C64.1822 8.81781 64.1822 9.25506 64.4008 9.61943L66.6599 13.5182C67.0243 14.1377 67.8623 14.2834 68.4089 13.8097C69.6842 12.6437 70.4858 10.9312 70.4858 9.07287C70.4858 7.21457 69.6842 5.50202 68.4089 4.33603C67.8623 3.75303 67.0243 3.89879 66.6599 4.55466Z"
          />
          {/*<path d="M10.08 25.3774V36.6974H3.24V7.97739H10.08V17.4974C10.8533 16.6441 11.68 15.9774 12.56 15.4974C13.44 15.0174 14.56 14.7774 15.92 14.7774C18.0533 14.7774 19.7867 15.4707 21.12 16.8574C22.48 18.2441 23.16 20.2441 23.16 22.8574V36.6974H16.32V25.1374C16.32 23.7774 16.0667 22.7374 15.56 22.0174C15.08 21.2974 14.32 20.9374 13.28 20.9374C12.72 20.9374 12.1867 21.0841 11.68 21.3774C11.2 21.6707 10.8133 22.1374 10.52 22.7774C10.2267 23.4174 10.08 24.2841 10.08 25.3774ZM38.2188 27.4574V15.1774H45.0588V36.6974H38.7788V34.3774C38.1921 35.1774 37.3521 35.8307 36.2588 36.3374C35.1921 36.8441 34.0321 37.0974 32.7788 37.0974C31.3654 37.0974 30.0854 36.8041 28.9388 36.2174C27.7921 35.6041 26.8854 34.6841 26.2188 33.4574C25.5788 32.2041 25.2588 30.6307 25.2588 28.7374V15.1774H32.0988V27.4574C32.0988 28.6307 32.3654 29.5107 32.8988 30.0974C33.4588 30.6841 34.2188 30.9774 35.1788 30.9774C35.6321 30.9774 36.0854 30.8574 36.5388 30.6174C37.0188 30.3507 37.4188 29.9641 37.7388 29.4574C38.0588 28.9241 38.2188 28.2574 38.2188 27.4574ZM68.2013 15.1774L57.9613 44.4174H50.4813L53.4813 36.4574L45.0812 15.1774H52.5213L57.1613 28.4974L61.3213 15.1774H68.2013ZM75.0956 25.3774V36.6974H68.2556V15.1774H74.5356V17.7774C75.389 16.8441 76.3223 16.1107 77.3356 15.5774C78.3756 15.0441 79.5756 14.7774 80.9356 14.7774C83.069 14.7774 84.8023 15.4707 86.1356 16.8574C87.4956 18.2441 88.1756 20.2441 88.1756 22.8574V36.6974H81.3356V25.1374C81.3356 23.7774 81.0823 22.7374 80.5756 22.0174C80.0956 21.2974 79.3356 20.9374 78.2956 20.9374C77.7356 20.9374 77.2023 21.0841 76.6956 21.3774C76.2156 21.6707 75.829 22.1374 75.5356 22.7774C75.2423 23.4174 75.0956 24.2841 75.0956 25.3774ZM100.074 44.8174C98.101 44.8174 96.3544 44.4707 94.8344 43.7774C93.3144 43.1107 92.1144 42.1507 91.2344 40.8974C90.3544 39.6441 89.8744 38.1907 89.7944 36.5374H96.4344C96.5677 37.4974 96.9277 38.2307 97.5144 38.7374C98.1277 39.2441 98.9677 39.4974 100.034 39.4974C101.314 39.4974 102.274 39.1641 102.914 38.4974C103.581 37.8307 103.914 36.8441 103.914 35.5374V33.0174C103.354 33.8174 102.594 34.4441 101.634 34.8974C100.674 35.3507 99.6077 35.5774 98.4344 35.5774C96.701 35.5774 95.1277 35.1241 93.7144 34.2174C92.301 33.2841 91.181 32.0307 90.3544 30.4574C89.5277 28.8841 89.1144 27.1241 89.1144 25.1774C89.1144 23.1507 89.501 21.3641 90.2744 19.8174C91.0477 18.2441 92.1144 17.0174 93.4744 16.1374C94.8344 15.2307 96.3944 14.7774 98.1544 14.7774C99.5144 14.7774 100.701 14.9907 101.714 15.4174C102.728 15.8174 103.648 16.4707 104.474 17.3774V15.1774H110.754V35.4574C110.754 38.3641 109.794 40.6441 107.874 42.2974C105.981 43.9774 103.381 44.8174 100.074 44.8174ZM96.0344 25.2174C96.0344 26.5507 96.381 27.6174 97.0744 28.4174C97.7677 29.2174 98.6877 29.6174 99.8344 29.6174C100.634 29.6174 101.328 29.4307 101.914 29.0574C102.528 28.6841 102.994 28.1641 103.314 27.4974C103.661 26.8307 103.834 26.0574 103.834 25.1774C103.834 23.8441 103.461 22.7774 102.714 21.9774C101.994 21.1507 101.034 20.7374 99.8344 20.7374C98.6877 20.7374 97.7677 21.1507 97.0744 21.9774C96.381 22.7774 96.0344 23.8574 96.0344 25.2174Z" />*/}
          {/* <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M113.5 1.5H111V6.50001H113.5C112.119 6.50001 111 7.61931 111 9.00001V11.5H116V9.00001C116 10.3807 117.119 11.5 118.5 11.5H121V6.50001H118.5C119.881 6.50001 121 5.38072 121 4V1.5H116V4C116 2.61929 114.881 1.5 113.5 1.5ZM116 6.50001H113.5C114.881 6.50001 116 7.61931 116 9.00001V6.50001ZM116 6.50001V4C116 5.38072 117.119 6.50001 118.5 6.50001H116Z"
          /> */}
        </svg>
      </a>
      <nav className="space-x-7 font-grotesk text-body-3 sm:block">
        <a href="#about" className="group relative hidden md:inline-block">
          <span>about</span>
          <span className="absolute bottom-0 left-0 h-[0.125em] w-0 rounded-full bg-secondary-600 duration-300 ease-in-out group-hover:w-full"></span>
        </a>
        <a href="#services" className="group relative hidden md:inline-block">
          <span>services</span>
          <span className="absolute bottom-0 left-0 h-[0.125em] w-0 rounded-full bg-secondary-600 duration-300 ease-in-out group-hover:w-full"></span>
        </a>
        <a href="#works" className="group relative hidden md:inline-block">
          <span>projects</span>
          <span className="absolute bottom-0 left-0 h-[0.125em] w-0 rounded-full bg-secondary-600 duration-300 ease-in-out group-hover:w-full"></span>
        </a>
        <a
          ref={cta}
          className="button group relative hover:bg-transparent"
          href="#contact"
        >
          <span className="relative w-fit">
            <span className="absolute bottom-2 h-[0.15em] w-0 bg-secondary-700 opacity-90 duration-300 ease-out group-hover:w-full"></span>
            <span>Let&apos;s Talk.</span>
          </span>
        </a>
      </nav>
    </header>
  );
}
